-- Feature list: year_range,student,age_avg_1y_avg,age_avg_1y_max,age_avg_1y_min,age_avg_2y_avg,age_avg_2y_max,age_avg_2y_min,age_avg_3y_avg,age_avg_3y_max,age_avg_3y_min,school_interventions_all_1y_all,school_interventions_all_1y_any,school_interventions_all_2y_all,school_interventions_all_2y_any,school_interventions_all_3y_all,school_interventions_all_3y_any,school_owner_other_all_1y_all,school_owner_other_all_1y_any,school_owner_other_all_2y_all,school_owner_other_all_2y_any,school_owner_other_all_3y_all,school_owner_other_all_3y_any,school_count_1y_avg,school_count_1y_max,school_count_1y_min,school_count_2y_avg,school_count_2y_max,school_count_2y_min,school_count_3y_avg,school_count_3y_max,school_count_3y_min,school_program_gendered_violence_all_1y_all,school_program_gendered_violence_all_1y_any,school_program_gendered_violence_all_2y_all,school_program_gendered_violence_all_2y_any,school_program_gendered_violence_all_3y_all,school_program_gendered_violence_all_3y_any,overage1_1y_avg,overage1_1y_max,overage1_1y_min,overage1_2y_avg,overage1_2y_max,overage1_2y_min,overage1_3y_avg,overage1_3y_max,overage1_3y_min,grado_code_1y_avg,grado_code_1y_max,grado_code_1y_min,grado_code_2y_avg,grado_code_2y_max,grado_code_2y_min,grado_code_3y_avg,grado_code_3y_max,grado_code_3y_min,school_difference_max_1y_avg,school_difference_max_1y_max,school_difference_max_1y_min,school_difference_max_2y_avg,school_difference_max_2y_max,school_difference_max_2y_min,school_difference_max_3y_avg,school_difference_max_3y_max,school_difference_max_3y_min,school_toiletpit_avg_1y_avg,school_toiletpit_avg_1y_max,school_toiletpit_avg_1y_min,school_toiletpit_avg_2y_avg,school_toiletpit_avg_2y_max,school_toiletpit_avg_2y_min,school_toiletpit_avg_3y_avg,school_toiletpit_avg_3y_max,school_toiletpit_avg_3y_min,school_program_gendered_violence_any_1y_all,school_program_gendered_violence_any_1y_any,school_program_gendered_violence_any_2y_all,school_program_gendered_violence_any_2y_any,school_program_gendered_violence_any_3y_all,school_program_gendered_violence_any_3y_any,school_toiletpit_min_1y_avg,school_toiletpit_min_1y_max,school_toiletpit_min_1y_min,school_toiletpit_min_2y_avg,school_toiletpit_min_2y_max,school_toiletpit_min_2y_min,school_toiletpit_min_3y_avg,school_toiletpit_min_3y_max,school_toiletpit_min_3y_min,family_members_max_1y_avg,family_members_max_1y_max,family_members_max_1y_min,family_members_max_2y_avg,family_members_max_2y_max,family_members_max_2y_min,family_members_max_3y_avg,family_members_max_3y_max,family_members_max_3y_min,school_public_1y_all,school_public_1y_any,school_public_2y_all,school_public_2y_any,school_public_3y_all,school_public_3y_any,overage_bool_1y_avg,overage_bool_1y_max,overage_bool_1y_min,overage_bool_2y_avg,overage_bool_2y_max,overage_bool_2y_min,overage_bool_3y_avg,overage_bool_3y_max,overage_bool_3y_min,school_mismatch_1y_avg,school_mismatch_1y_max,school_mismatch_1y_min,school_mismatch_2y_avg,school_mismatch_2y_max,school_mismatch_2y_min,school_mismatch_3y_avg,school_mismatch_3y_max,school_mismatch_3y_min,age_min_1y_avg,age_min_1y_max,age_min_1y_min,age_min_2y_avg,age_min_2y_max,age_min_2y_min,age_min_3y_avg,age_min_3y_max,age_min_3y_min,school_owner_loan_all_1y_all,school_owner_loan_all_1y_any,school_owner_loan_all_2y_all,school_owner_loan_all_2y_any,school_owner_loan_all_3y_all,school_owner_loan_all_3y_any,school_toilet_max_1y_avg,school_toilet_max_1y_max,school_toilet_max_1y_min,school_toilet_max_2y_avg,school_toilet_max_2y_max,school_toilet_max_2y_min,school_toilet_max_3y_avg,school_toilet_max_3y_max,school_toilet_max_3y_min,grado_code_min_1y_avg,grado_code_min_1y_max,grado_code_min_1y_min,grado_code_min_2y_avg,grado_code_min_2y_max,grado_code_min_2y_min,grado_code_min_3y_avg,grado_code_min_3y_max,grado_code_min_3y_min,school_native_1y_all,school_native_1y_any,school_native_2y_all,school_native_2y_any,school_native_3y_all,school_native_3y_any,family_members_avg_1y_avg,family_members_avg_1y_max,family_members_avg_1y_min,family_members_avg_2y_avg,family_members_avg_2y_max,family_members_avg_2y_min,family_members_avg_3y_avg,family_members_avg_3y_max,family_members_avg_3y_min,overage2_bool_1y_avg,overage2_bool_1y_max,overage2_bool_1y_min,overage2_bool_2y_avg,overage2_bool_2y_max,overage2_bool_2y_min,overage2_bool_3y_avg,overage2_bool_3y_max,overage2_bool_3y_min,age_1y_avg,age_1y_max,age_1y_min,age_2y_avg,age_2y_max,age_2y_min,age_3y_avg,age_3y_max,age_3y_min,age_max_1y_avg,age_max_1y_max,age_max_1y_min,age_max_2y_avg,age_max_2y_max,age_max_2y_min,age_max_3y_avg,age_max_3y_max,age_max_3y_min,grado_code_avg_1y_avg,grado_code_avg_1y_max,grado_code_avg_1y_min,grado_code_avg_2y_avg,grado_code_avg_2y_max,grado_code_avg_2y_min,grado_code_avg_3y_avg,grado_code_avg_3y_max,grado_code_avg_3y_min,school_index_min_1y_avg,school_index_min_1y_max,school_index_min_1y_min,school_index_min_2y_avg,school_index_min_2y_max,school_index_min_2y_min,school_index_min_3y_avg,school_index_min_3y_max,school_index_min_3y_min,school_classrooms_max_1y_avg,school_classrooms_max_1y_max,school_classrooms_max_1y_min,school_classrooms_max_2y_avg,school_classrooms_max_2y_max,school_classrooms_max_2y_min,school_classrooms_max_3y_avg,school_classrooms_max_3y_max,school_classrooms_max_3y_min,school_toiletseptic_avg_1y_avg,school_toiletseptic_avg_1y_max,school_toiletseptic_avg_1y_min,school_toiletseptic_avg_2y_avg,school_toiletseptic_avg_2y_max,school_toiletseptic_avg_2y_min,school_toiletseptic_avg_3y_avg,school_toiletseptic_avg_3y_max,school_toiletseptic_avg_3y_min,school_program_safe_school_1y,school_program_safe_school_1y_count,school_program_safe_school_2y,school_program_safe_school_2y_count,school_program_safe_school_3y,school_program_safe_school_3y_count,school_toiletsepticworks_min_1y_avg,school_toiletsepticworks_min_1y_max,school_toiletsepticworks_min_1y_min,school_toiletsepticworks_min_2y_avg,school_toiletsepticworks_min_2y_max,school_toiletsepticworks_min_2y_min,school_toiletsepticworks_min_3y_avg,school_toiletsepticworks_min_3y_max,school_toiletsepticworks_min_3y_min,school_owner_own_all_1y_all,school_owner_own_all_1y_any,school_owner_own_all_2y_all,school_owner_own_all_2y_any,school_owner_own_all_3y_all,school_owner_own_all_3y_any,commute_count_1y_avg,commute_count_1y_max,commute_count_1y_min,commute_count_2y_avg,commute_count_2y_max,commute_count_2y_min,commute_count_3y_avg,commute_count_3y_max,commute_count_3y_min,school_rural_1y_all,school_rural_1y_any,school_rural_2y_all,school_rural_2y_any,school_rural_3y_all,school_rural_3y_any,school_toiletworks_avg_1y_avg,school_toiletworks_avg_1y_max,school_toiletworks_avg_1y_min,school_toiletworks_avg_2y_avg,school_toiletworks_avg_2y_max,school_toiletworks_avg_2y_min,school_toiletworks_avg_3y_avg,school_toiletworks_avg_3y_max,school_toiletworks_avg_3y_min,school_index_max_1y_avg,school_index_max_1y_max,school_index_max_1y_min,school_index_max_2y_avg,school_index_max_2y_max,school_index_max_2y_min,school_index_max_3y_avg,school_index_max_3y_max,school_index_max_3y_min,school_classrooms_avg_1y_avg,school_classrooms_avg_1y_max,school_classrooms_avg_1y_min,school_classrooms_avg_2y_avg,school_classrooms_avg_2y_max,school_classrooms_avg_2y_min,school_classrooms_avg_3y_avg,school_classrooms_avg_3y_max,school_classrooms_avg_3y_min,school_prostitution_all_1y_all,school_prostitution_all_1y_any,school_prostitution_all_2y_all,school_prostitution_all_2y_any,school_prostitution_all_3y_all,school_prostitution_all_3y_any,school_teachers_avg_1y_avg,school_teachers_avg_1y_max,school_teachers_avg_1y_min,school_teachers_avg_2y_avg,school_teachers_avg_2y_max,school_teachers_avg_2y_min,school_teachers_avg_3y_avg,school_teachers_avg_3y_max,school_teachers_avg_3y_min,repeats_bool_1y_avg,repeats_bool_1y_max,repeats_bool_1y_min,repeats_bool_2y_avg,repeats_bool_2y_max,repeats_bool_2y_min,repeats_bool_3y_avg,repeats_bool_3y_max,repeats_bool_3y_min,school_difference_avg_1y_avg,school_difference_avg_1y_max,school_difference_avg_1y_min,school_difference_avg_2y_avg,school_difference_avg_2y_max,school_difference_avg_2y_min,school_difference_avg_3y_avg,school_difference_avg_3y_max,school_difference_avg_3y_min,commute_1y,commute_1y_count,commute_2y,commute_2y_count,commute_3y,commute_3y_count,school_native_any_1y_all,school_native_any_1y_any,school_native_any_2y_all,school_native_any_2y_any,school_native_any_3y_all,school_native_any_3y_any,school_municipio_count_1y_avg,school_municipio_count_1y_max,school_municipio_count_1y_min,school_municipio_count_2y_avg,school_municipio_count_2y_max,school_municipio_count_2y_min,school_municipio_count_3y_avg,school_municipio_count_3y_max,school_municipio_count_3y_min,school_toiletseptic_max_1y_avg,school_toiletseptic_max_1y_max,school_toiletseptic_max_1y_min,school_toiletseptic_max_2y_avg,school_toiletseptic_max_2y_max,school_toiletseptic_max_2y_min,school_toiletseptic_max_3y_avg,school_toiletseptic_max_3y_max,school_toiletseptic_max_3y_min,school_toiletworks_min_1y_avg,school_toiletworks_min_1y_max,school_toiletworks_min_1y_min,school_toiletworks_min_2y_avg,school_toiletworks_min_2y_max,school_toiletworks_min_2y_min,school_toiletworks_min_3y_avg,school_toiletworks_min_3y_max,school_toiletworks_min_3y_min,school_program_safe_school_count_avg_1y_avg,school_program_safe_school_count_avg_1y_max,school_program_safe_school_count_avg_1y_min,school_program_safe_school_count_avg_2y_avg,school_program_safe_school_count_avg_2y_max,school_program_safe_school_count_avg_2y_min,school_program_safe_school_count_avg_3y_avg,school_program_safe_school_count_avg_3y_max,school_program_safe_school_count_avg_3y_min,overage2_1y_avg,overage2_1y_max,overage2_1y_min,overage2_2y_avg,overage2_2y_max,overage2_2y_min,overage2_3y_avg,overage2_3y_max,overage2_3y_min,school_owner_borrow_all_1y_all,school_owner_borrow_all_1y_any,school_owner_borrow_all_2y_all,school_owner_borrow_all_2y_any,school_owner_borrow_all_3y_all,school_owner_borrow_all_3y_any,grado_code_max_1y_avg,grado_code_max_1y_max,grado_code_max_1y_min,grado_code_max_2y_avg,grado_code_max_2y_max,grado_code_max_2y_min,grado_code_max_3y_avg,grado_code_max_3y_max,grado_code_max_3y_min,student_female_1y_avg,student_female_1y_max,student_female_1y_min,student_female_2y_avg,student_female_2y_max,student_female_2y_min,student_female_3y_avg,student_female_3y_max,student_female_3y_min,school_program_pase_all_1y_all,school_program_pase_all_1y_any,school_program_pase_all_2y_all,school_program_pase_all_2y_any,school_program_pase_all_3y_all,school_program_pase_all_3y_any,school_rape2_any_1y_all,school_rape2_any_1y_any,school_rape2_any_2y_all,school_rape2_any_2y_any,school_rape2_any_3y_all,school_rape2_any_3y_any,school_electricity_any_1y_all,school_electricity_any_1y_any,school_electricity_any_2y_all,school_electricity_any_2y_any,school_electricity_any_3y_all,school_electricity_any_3y_any,school_difference_1y_avg,school_difference_1y_max,school_difference_1y_min,school_difference_2y_avg,school_difference_2y_max,school_difference_2y_min,school_difference_3y_avg,school_difference_3y_max,school_difference_3y_min,school_owner_lease_all_1y_all,school_owner_lease_all_1y_any,school_owner_lease_all_2y_all,school_owner_lease_all_2y_any,school_owner_lease_all_3y_all,school_owner_lease_all_3y_any,school_owner_own_any_1y_all,school_owner_own_any_1y_any,school_owner_own_any_2y_all,school_owner_own_any_2y_any,school_owner_own_any_3y_all,school_owner_own_any_3y_any,school_toilet_min_1y_avg,school_toilet_min_1y_max,school_toilet_min_1y_min,school_toilet_min_2y_avg,school_toilet_min_2y_max,school_toilet_min_2y_min,school_toilet_min_3y_avg,school_toilet_min_3y_max,school_toilet_min_3y_min,municipio_1y,municipio_1y_count,municipio_2y,municipio_2y_count,municipio_3y,municipio_3y_count,school_native_all_1y_all,school_native_all_1y_any,school_native_all_2y_all,school_native_all_2y_any,school_native_all_3y_all,school_native_all_3y_any,school_toiletpit_max_1y_avg,school_toiletpit_max_1y_max,school_toiletpit_max_1y_min,school_toiletpit_max_2y_avg,school_toiletpit_max_2y_max,school_toiletpit_max_2y_min,school_toiletpit_max_3y_avg,school_toiletpit_max_3y_max,school_toiletpit_max_3y_min,school_rural_all_1y_all,school_rural_all_1y_any,school_rural_all_2y_all,school_rural_all_2y_any,school_rural_all_3y_all,school_rural_all_3y_any,school_prostitution_any_1y_all,school_prostitution_any_1y_any,school_prostitution_any_2y_all,school_prostitution_any_2y_any,school_prostitution_any_3y_all,school_prostitution_any_3y_any,school_toiletpitworks_avg_1y_avg,school_toiletpitworks_avg_1y_max,school_toiletpitworks_avg_1y_min,school_toiletpitworks_avg_2y_avg,school_toiletpitworks_avg_2y_max,school_toiletpitworks_avg_2y_min,school_toiletpitworks_avg_3y_avg,school_toiletpitworks_avg_3y_max,school_toiletpitworks_avg_3y_min,repeats_1y_avg,repeats_1y_max,repeats_1y_min,repeats_2y_avg,repeats_2y_max,repeats_2y_min,repeats_3y_avg,repeats_3y_max,repeats_3y_min,school_toiletpitworks_max_1y_avg,school_toiletpitworks_max_1y_max,school_toiletpitworks_max_1y_min,school_toiletpitworks_max_2y_avg,school_toiletpitworks_max_2y_max,school_toiletpitworks_max_2y_min,school_toiletpitworks_max_3y_avg,school_toiletpitworks_max_3y_max,school_toiletpitworks_max_3y_min,school_rape_all_1y_all,school_rape_all_1y_any,school_rape_all_2y_all,school_rape_all_2y_any,school_rape_all_3y_all,school_rape_all_3y_any,family_members_1y_avg,family_members_1y_max,family_members_1y_min,family_members_2y_avg,family_members_2y_max,family_members_2y_min,family_members_3y_avg,family_members_3y_max,family_members_3y_min,school_toilet_1y_avg,school_toilet_1y_max,school_toilet_1y_min,school_toilet_2y_avg,school_toilet_2y_max,school_toilet_2y_min,school_toilet_3y_avg,school_toilet_3y_max,school_toilet_3y_min,school_teachers_min_1y_avg,school_teachers_min_1y_max,school_teachers_min_1y_min,school_teachers_min_2y_avg,school_teachers_min_2y_max,school_teachers_min_2y_min,school_teachers_min_3y_avg,school_teachers_min_3y_max,school_teachers_min_3y_min,school_municipio_1y,school_municipio_1y_count,school_municipio_2y,school_municipio_2y_count,school_municipio_3y,school_municipio_3y_count,school_1y,school_1y_count,school_2y,school_2y_count,school_3y,school_3y_count,school_owner_borrow_any_1y_all,school_owner_borrow_any_1y_any,school_owner_borrow_any_2y_all,school_owner_borrow_any_2y_any,school_owner_borrow_any_3y_all,school_owner_borrow_any_3y_any,school_teachers_1y_avg,school_teachers_1y_max,school_teachers_1y_min,school_teachers_2y_avg,school_teachers_2y_max,school_teachers_2y_min,school_teachers_3y_avg,school_teachers_3y_max,school_teachers_3y_min,school_rape2_all_1y_all,school_rape2_all_1y_any,school_rape2_all_2y_all,school_rape2_all_2y_any,school_rape2_all_3y_all,school_rape2_all_3y_any,school_mismatch_max_1y_avg,school_mismatch_max_1y_max,school_mismatch_max_1y_min,school_mismatch_max_2y_avg,school_mismatch_max_2y_max,school_mismatch_max_2y_min,school_mismatch_max_3y_avg,school_mismatch_max_3y_max,school_mismatch_max_3y_min,school_public_any_1y_all,school_public_any_1y_any,school_public_any_2y_all,school_public_any_2y_any,school_public_any_3y_all,school_public_any_3y_any,school_vaso_de_leche_any_1y_all,school_vaso_de_leche_any_1y_any,school_vaso_de_leche_any_2y_all,school_vaso_de_leche_any_2y_any,school_vaso_de_leche_any_3y_all,school_vaso_de_leche_any_3y_any,school_difference_min_1y_avg,school_difference_min_1y_max,school_difference_min_1y_min,school_difference_min_2y_avg,school_difference_min_2y_max,school_difference_min_2y_min,school_difference_min_3y_avg,school_difference_min_3y_max,school_difference_min_3y_min,school_public_all_1y_all,school_public_all_1y_any,school_public_all_2y_all,school_public_all_2y_any,school_public_all_3y_all,school_public_all_3y_any,school_toiletpitworks_min_1y_avg,school_toiletpitworks_min_1y_max,school_toiletpitworks_min_1y_min,school_toiletpitworks_min_2y_avg,school_toiletpitworks_min_2y_max,school_toiletpitworks_min_2y_min,school_toiletpitworks_min_3y_avg,school_toiletpitworks_min_3y_max,school_toiletpitworks_min_3y_min,school_toiletsepticworks_max_1y_avg,school_toiletsepticworks_max_1y_max,school_toiletsepticworks_max_1y_min,school_toiletsepticworks_max_2y_avg,school_toiletsepticworks_max_2y_max,school_toiletsepticworks_max_2y_min,school_toiletsepticworks_max_3y_avg,school_toiletsepticworks_max_3y_max,school_toiletsepticworks_max_3y_min,school_index_avg_1y_avg,school_index_avg_1y_max,school_index_avg_1y_min,school_index_avg_2y_avg,school_index_avg_2y_max,school_index_avg_2y_min,school_index_avg_3y_avg,school_index_avg_3y_max,school_index_avg_3y_min,school_vaso_de_leche_all_1y_all,school_vaso_de_leche_all_1y_any,school_vaso_de_leche_all_2y_all,school_vaso_de_leche_all_2y_any,school_vaso_de_leche_all_3y_all,school_vaso_de_leche_all_3y_any,school_rape_any_1y_all,school_rape_any_1y_any,school_rape_any_2y_all,school_rape_any_2y_any,school_rape_any_3y_all,school_rape_any_3y_any,school_owner_other_any_1y_all,school_owner_other_any_1y_any,school_owner_other_any_2y_all,school_owner_other_any_2y_any,school_owner_other_any_3y_all,school_owner_other_any_3y_any,school_toiletseptic_min_1y_avg,school_toiletseptic_min_1y_max,school_toiletseptic_min_1y_min,school_toiletseptic_min_2y_avg,school_toiletseptic_min_2y_max,school_toiletseptic_min_2y_min,school_toiletseptic_min_3y_avg,school_toiletseptic_min_3y_max,school_toiletseptic_min_3y_min,departamento_1y,departamento_1y_count,departamento_2y,departamento_2y_count,departamento_3y,departamento_3y_count,school_departamento_count_1y_avg,school_departamento_count_1y_max,school_departamento_count_1y_min,school_departamento_count_2y_avg,school_departamento_count_2y_max,school_departamento_count_2y_min,school_departamento_count_3y_avg,school_departamento_count_3y_max,school_departamento_count_3y_min,school_classrooms_min_1y_avg,school_classrooms_min_1y_max,school_classrooms_min_1y_min,school_classrooms_min_2y_avg,school_classrooms_min_2y_max,school_classrooms_min_2y_min,school_classrooms_min_3y_avg,school_classrooms_min_3y_max,school_classrooms_min_3y_min,school_owner_loan_any_1y_all,school_owner_loan_any_1y_any,school_owner_loan_any_2y_all,school_owner_loan_any_2y_any,school_owner_loan_any_3y_all,school_owner_loan_any_3y_any,school_teachers_max_1y_avg,school_teachers_max_1y_max,school_teachers_max_1y_min,school_teachers_max_2y_avg,school_teachers_max_2y_max,school_teachers_max_2y_min,school_teachers_max_3y_avg,school_teachers_max_3y_max,school_teachers_max_3y_min,municipio_count_1y_avg,municipio_count_1y_max,municipio_count_1y_min,municipio_count_2y_avg,municipio_count_2y_max,municipio_count_2y_min,municipio_count_3y_avg,municipio_count_3y_max,municipio_count_3y_min,school_mismatch_min_1y_avg,school_mismatch_min_1y_max,school_mismatch_min_1y_min,school_mismatch_min_2y_avg,school_mismatch_min_2y_max,school_mismatch_min_2y_min,school_mismatch_min_3y_avg,school_mismatch_min_3y_max,school_mismatch_min_3y_min,school_interventions_any_1y_all,school_interventions_any_1y_any,school_interventions_any_2y_all,school_interventions_any_2y_any,school_interventions_any_3y_all,school_interventions_any_3y_any,school_program_safe_school_count_1y_avg,school_program_safe_school_count_1y_max,school_program_safe_school_count_1y_min,school_program_safe_school_count_2y_avg,school_program_safe_school_count_2y_max,school_program_safe_school_count_2y_min,school_program_safe_school_count_3y_avg,school_program_safe_school_count_3y_max,school_program_safe_school_count_3y_min,school_owner_lease_any_1y_all,school_owner_lease_any_1y_any,school_owner_lease_any_2y_all,school_owner_lease_any_2y_any,school_owner_lease_any_3y_all,school_owner_lease_any_3y_any,school_departamento_1y,school_departamento_1y_count,school_departamento_2y,school_departamento_2y_count,school_departamento_3y,school_departamento_3y_count,school_classrooms_1y_avg,school_classrooms_1y_max,school_classrooms_1y_min,school_classrooms_2y_avg,school_classrooms_2y_max,school_classrooms_2y_min,school_classrooms_3y_avg,school_classrooms_3y_max,school_classrooms_3y_min,school_program_safe_school_count_max_1y_avg,school_program_safe_school_count_max_1y_max,school_program_safe_school_count_max_1y_min,school_program_safe_school_count_max_2y_avg,school_program_safe_school_count_max_2y_max,school_program_safe_school_count_max_2y_min,school_program_safe_school_count_max_3y_avg,school_program_safe_school_count_max_3y_max,school_program_safe_school_count_max_3y_min,family_members_min_1y_avg,family_members_min_1y_max,family_members_min_1y_min,family_members_min_2y_avg,family_members_min_2y_max,family_members_min_2y_min,family_members_min_3y_avg,family_members_min_3y_max,family_members_min_3y_min,school_electricity_all_1y_all,school_electricity_all_1y_any,school_electricity_all_2y_all,school_electricity_all_2y_any,school_electricity_all_3y_all,school_electricity_all_3y_any,school_program_safe_school_count_min_1y_avg,school_program_safe_school_count_min_1y_max,school_program_safe_school_count_min_1y_min,school_program_safe_school_count_min_2y_avg,school_program_safe_school_count_min_2y_max,school_program_safe_school_count_min_2y_min,school_program_safe_school_count_min_3y_avg,school_program_safe_school_count_min_3y_max,school_program_safe_school_count_min_3y_min,school_electricitycompany_any_1y_all,school_electricitycompany_any_1y_any,school_electricitycompany_any_2y_all,school_electricitycompany_any_2y_any,school_electricitycompany_any_3y_all,school_electricitycompany_any_3y_any,school_electricitycompany_all_1y_all,school_electricitycompany_all_1y_any,school_electricitycompany_all_2y_all,school_electricitycompany_all_2y_any,school_electricitycompany_all_3y_all,school_electricitycompany_all_3y_any,school_toilet_avg_1y_avg,school_toilet_avg_1y_max,school_toilet_avg_1y_min,school_toilet_avg_2y_avg,school_toilet_avg_2y_max,school_toilet_avg_2y_min,school_toilet_avg_3y_avg,school_toilet_avg_3y_max,school_toilet_avg_3y_min,school_toiletsepticworks_avg_1y_avg,school_toiletsepticworks_avg_1y_max,school_toiletsepticworks_avg_1y_min,school_toiletsepticworks_avg_2y_avg,school_toiletsepticworks_avg_2y_max,school_toiletsepticworks_avg_2y_min,school_toiletsepticworks_avg_3y_avg,school_toiletsepticworks_avg_3y_max,school_toiletsepticworks_avg_3y_min,departamento_count_1y_avg,departamento_count_1y_max,departamento_count_1y_min,departamento_count_2y_avg,departamento_count_2y_max,departamento_count_2y_min,departamento_count_3y_avg,departamento_count_3y_max,departamento_count_3y_min,school_rural_any_1y_all,school_rural_any_1y_any,school_rural_any_2y_all,school_rural_any_2y_any,school_rural_any_3y_all,school_rural_any_3y_any,school_program_pase_any_1y_all,school_program_pase_any_1y_any,school_program_pase_any_2y_all,school_program_pase_any_2y_any,school_program_pase_any_3y_all,school_program_pase_any_3y_any,school_mismatch_avg_1y_avg,school_mismatch_avg_1y_max,school_mismatch_avg_1y_min,school_mismatch_avg_2y_avg,school_mismatch_avg_2y_max,school_mismatch_avg_2y_min,school_mismatch_avg_3y_avg,school_mismatch_avg_3y_max,school_mismatch_avg_3y_min,school_toiletworks_max_1y_avg,school_toiletworks_max_1y_max,school_toiletworks_max_1y_min,school_toiletworks_max_2y_avg,school_toiletworks_max_2y_max,school_toiletworks_max_2y_min,school_toiletworks_max_3y_avg,school_toiletworks_max_3y_max,school_toiletworks_max_3y_min
set role el_salvador_mined_education_write; drop table if exists results.features_aggregate2; create table results.features_aggregate2 as (select a.*,avg(c.age_avg) over w_1y as age_avg_1y_avg,max(c.age_avg) over w_1y as age_avg_1y_max,min(c.age_avg) over w_1y as age_avg_1y_min,avg(c.age_avg) over w_2y as age_avg_2y_avg,max(c.age_avg) over w_2y as age_avg_2y_max,min(c.age_avg) over w_2y as age_avg_2y_min,avg(c.age_avg) over w_3y as age_avg_3y_avg,max(c.age_avg) over w_3y as age_avg_3y_max,min(c.age_avg) over w_3y as age_avg_3y_min,(bool_and(c.school_interventions_all) over w_1y)::int as school_interventions_all_1y_all,(bool_or(c.school_interventions_all) over w_1y)::int as school_interventions_all_1y_any,(bool_and(c.school_interventions_all) over w_2y)::int as school_interventions_all_2y_all,(bool_or(c.school_interventions_all) over w_2y)::int as school_interventions_all_2y_any,(bool_and(c.school_interventions_all) over w_3y)::int as school_interventions_all_3y_all,(bool_or(c.school_interventions_all) over w_3y)::int as school_interventions_all_3y_any,(bool_and(c.school_owner_other_all) over w_1y)::int as school_owner_other_all_1y_all,(bool_or(c.school_owner_other_all) over w_1y)::int as school_owner_other_all_1y_any,(bool_and(c.school_owner_other_all) over w_2y)::int as school_owner_other_all_2y_all,(bool_or(c.school_owner_other_all) over w_2y)::int as school_owner_other_all_2y_any,(bool_and(c.school_owner_other_all) over w_3y)::int as school_owner_other_all_3y_all,(bool_or(c.school_owner_other_all) over w_3y)::int as school_owner_other_all_3y_any,avg(c.school_count) over w_1y as school_count_1y_avg,max(c.school_count) over w_1y as school_count_1y_max,min(c.school_count) over w_1y as school_count_1y_min,avg(c.school_count) over w_2y as school_count_2y_avg,max(c.school_count) over w_2y as school_count_2y_max,min(c.school_count) over w_2y as school_count_2y_min,avg(c.school_count) over w_3y as school_count_3y_avg,max(c.school_count) over w_3y as school_count_3y_max,min(c.school_count) over w_3y as school_count_3y_min,(bool_and(c.school_program_gendered_violence_all) over w_1y)::int as school_program_gendered_violence_all_1y_all,(bool_or(c.school_program_gendered_violence_all) over w_1y)::int as school_program_gendered_violence_all_1y_any,(bool_and(c.school_program_gendered_violence_all) over w_2y)::int as school_program_gendered_violence_all_2y_all,(bool_or(c.school_program_gendered_violence_all) over w_2y)::int as school_program_gendered_violence_all_2y_any,(bool_and(c.school_program_gendered_violence_all) over w_3y)::int as school_program_gendered_violence_all_3y_all,(bool_or(c.school_program_gendered_violence_all) over w_3y)::int as school_program_gendered_violence_all_3y_any,avg(a.overage1) over w_1y as overage1_1y_avg,max(a.overage1) over w_1y as overage1_1y_max,min(a.overage1) over w_1y as overage1_1y_min,avg(a.overage1) over w_2y as overage1_2y_avg,max(a.overage1) over w_2y as overage1_2y_max,min(a.overage1) over w_2y as overage1_2y_min,avg(a.overage1) over w_3y as overage1_3y_avg,max(a.overage1) over w_3y as overage1_3y_max,min(a.overage1) over w_3y as overage1_3y_min,avg(a.grado_code) over w_1y as grado_code_1y_avg,max(a.grado_code) over w_1y as grado_code_1y_max,min(a.grado_code) over w_1y as grado_code_1y_min,avg(a.grado_code) over w_2y as grado_code_2y_avg,max(a.grado_code) over w_2y as grado_code_2y_max,min(a.grado_code) over w_2y as grado_code_2y_min,avg(a.grado_code) over w_3y as grado_code_3y_avg,max(a.grado_code) over w_3y as grado_code_3y_max,min(a.grado_code) over w_3y as grado_code_3y_min,avg(c.school_difference_max) over w_1y as school_difference_max_1y_avg,max(c.school_difference_max) over w_1y as school_difference_max_1y_max,min(c.school_difference_max) over w_1y as school_difference_max_1y_min,avg(c.school_difference_max) over w_2y as school_difference_max_2y_avg,max(c.school_difference_max) over w_2y as school_difference_max_2y_max,min(c.school_difference_max) over w_2y as school_difference_max_2y_min,avg(c.school_difference_max) over w_3y as school_difference_max_3y_avg,max(c.school_difference_max) over w_3y as school_difference_max_3y_max,min(c.school_difference_max) over w_3y as school_difference_max_3y_min,avg(c.school_toiletpit_avg) over w_1y as school_toiletpit_avg_1y_avg,max(c.school_toiletpit_avg) over w_1y as school_toiletpit_avg_1y_max,min(c.school_toiletpit_avg) over w_1y as school_toiletpit_avg_1y_min,avg(c.school_toiletpit_avg) over w_2y as school_toiletpit_avg_2y_avg,max(c.school_toiletpit_avg) over w_2y as school_toiletpit_avg_2y_max,min(c.school_toiletpit_avg) over w_2y as school_toiletpit_avg_2y_min,avg(c.school_toiletpit_avg) over w_3y as school_toiletpit_avg_3y_avg,max(c.school_toiletpit_avg) over w_3y as school_toiletpit_avg_3y_max,min(c.school_toiletpit_avg) over w_3y as school_toiletpit_avg_3y_min,(bool_and(c.school_program_gendered_violence_any) over w_1y)::int as school_program_gendered_violence_any_1y_all,(bool_or(c.school_program_gendered_violence_any) over w_1y)::int as school_program_gendered_violence_any_1y_any,(bool_and(c.school_program_gendered_violence_any) over w_2y)::int as school_program_gendered_violence_any_2y_all,(bool_or(c.school_program_gendered_violence_any) over w_2y)::int as school_program_gendered_violence_any_2y_any,(bool_and(c.school_program_gendered_violence_any) over w_3y)::int as school_program_gendered_violence_any_3y_all,(bool_or(c.school_program_gendered_violence_any) over w_3y)::int as school_program_gendered_violence_any_3y_any,avg(c.school_toiletpit_min) over w_1y as school_toiletpit_min_1y_avg,max(c.school_toiletpit_min) over w_1y as school_toiletpit_min_1y_max,min(c.school_toiletpit_min) over w_1y as school_toiletpit_min_1y_min,avg(c.school_toiletpit_min) over w_2y as school_toiletpit_min_2y_avg,max(c.school_toiletpit_min) over w_2y as school_toiletpit_min_2y_max,min(c.school_toiletpit_min) over w_2y as school_toiletpit_min_2y_min,avg(c.school_toiletpit_min) over w_3y as school_toiletpit_min_3y_avg,max(c.school_toiletpit_min) over w_3y as school_toiletpit_min_3y_max,min(c.school_toiletpit_min) over w_3y as school_toiletpit_min_3y_min,avg(c.family_members_max) over w_1y as family_members_max_1y_avg,max(c.family_members_max) over w_1y as family_members_max_1y_max,min(c.family_members_max) over w_1y as family_members_max_1y_min,avg(c.family_members_max) over w_2y as family_members_max_2y_avg,max(c.family_members_max) over w_2y as family_members_max_2y_max,min(c.family_members_max) over w_2y as family_members_max_2y_min,avg(c.family_members_max) over w_3y as family_members_max_3y_avg,max(c.family_members_max) over w_3y as family_members_max_3y_max,min(c.family_members_max) over w_3y as family_members_max_3y_min,(bool_and(a.school_public) over w_1y)::int as school_public_1y_all,(bool_or(a.school_public) over w_1y)::int as school_public_1y_any,(bool_and(a.school_public) over w_2y)::int as school_public_2y_all,(bool_or(a.school_public) over w_2y)::int as school_public_2y_any,(bool_and(a.school_public) over w_3y)::int as school_public_3y_all,(bool_or(a.school_public) over w_3y)::int as school_public_3y_any,avg(a.overage_bool) over w_1y as overage_bool_1y_avg,max(a.overage_bool) over w_1y as overage_bool_1y_max,min(a.overage_bool) over w_1y as overage_bool_1y_min,avg(a.overage_bool) over w_2y as overage_bool_2y_avg,max(a.overage_bool) over w_2y as overage_bool_2y_max,min(a.overage_bool) over w_2y as overage_bool_2y_min,avg(a.overage_bool) over w_3y as overage_bool_3y_avg,max(a.overage_bool) over w_3y as overage_bool_3y_max,min(a.overage_bool) over w_3y as overage_bool_3y_min,avg(a.school_mismatch) over w_1y as school_mismatch_1y_avg,max(a.school_mismatch) over w_1y as school_mismatch_1y_max,min(a.school_mismatch) over w_1y as school_mismatch_1y_min,avg(a.school_mismatch) over w_2y as school_mismatch_2y_avg,max(a.school_mismatch) over w_2y as school_mismatch_2y_max,min(a.school_mismatch) over w_2y as school_mismatch_2y_min,avg(a.school_mismatch) over w_3y as school_mismatch_3y_avg,max(a.school_mismatch) over w_3y as school_mismatch_3y_max,min(a.school_mismatch) over w_3y as school_mismatch_3y_min,avg(c.age_min) over w_1y as age_min_1y_avg,max(c.age_min) over w_1y as age_min_1y_max,min(c.age_min) over w_1y as age_min_1y_min,avg(c.age_min) over w_2y as age_min_2y_avg,max(c.age_min) over w_2y as age_min_2y_max,min(c.age_min) over w_2y as age_min_2y_min,avg(c.age_min) over w_3y as age_min_3y_avg,max(c.age_min) over w_3y as age_min_3y_max,min(c.age_min) over w_3y as age_min_3y_min,(bool_and(c.school_owner_loan_all) over w_1y)::int as school_owner_loan_all_1y_all,(bool_or(c.school_owner_loan_all) over w_1y)::int as school_owner_loan_all_1y_any,(bool_and(c.school_owner_loan_all) over w_2y)::int as school_owner_loan_all_2y_all,(bool_or(c.school_owner_loan_all) over w_2y)::int as school_owner_loan_all_2y_any,(bool_and(c.school_owner_loan_all) over w_3y)::int as school_owner_loan_all_3y_all,(bool_or(c.school_owner_loan_all) over w_3y)::int as school_owner_loan_all_3y_any,avg(c.school_toilet_max) over w_1y as school_toilet_max_1y_avg,max(c.school_toilet_max) over w_1y as school_toilet_max_1y_max,min(c.school_toilet_max) over w_1y as school_toilet_max_1y_min,avg(c.school_toilet_max) over w_2y as school_toilet_max_2y_avg,max(c.school_toilet_max) over w_2y as school_toilet_max_2y_max,min(c.school_toilet_max) over w_2y as school_toilet_max_2y_min,avg(c.school_toilet_max) over w_3y as school_toilet_max_3y_avg,max(c.school_toilet_max) over w_3y as school_toilet_max_3y_max,min(c.school_toilet_max) over w_3y as school_toilet_max_3y_min,avg(c.grado_code_min) over w_1y as grado_code_min_1y_avg,max(c.grado_code_min) over w_1y as grado_code_min_1y_max,min(c.grado_code_min) over w_1y as grado_code_min_1y_min,avg(c.grado_code_min) over w_2y as grado_code_min_2y_avg,max(c.grado_code_min) over w_2y as grado_code_min_2y_max,min(c.grado_code_min) over w_2y as grado_code_min_2y_min,avg(c.grado_code_min) over w_3y as grado_code_min_3y_avg,max(c.grado_code_min) over w_3y as grado_code_min_3y_max,min(c.grado_code_min) over w_3y as grado_code_min_3y_min,(bool_and(a.school_native) over w_1y)::int as school_native_1y_all,(bool_or(a.school_native) over w_1y)::int as school_native_1y_any,(bool_and(a.school_native) over w_2y)::int as school_native_2y_all,(bool_or(a.school_native) over w_2y)::int as school_native_2y_any,(bool_and(a.school_native) over w_3y)::int as school_native_3y_all,(bool_or(a.school_native) over w_3y)::int as school_native_3y_any,avg(c.family_members_avg) over w_1y as family_members_avg_1y_avg,max(c.family_members_avg) over w_1y as family_members_avg_1y_max,min(c.family_members_avg) over w_1y as family_members_avg_1y_min,avg(c.family_members_avg) over w_2y as family_members_avg_2y_avg,max(c.family_members_avg) over w_2y as family_members_avg_2y_max,min(c.family_members_avg) over w_2y as family_members_avg_2y_min,avg(c.family_members_avg) over w_3y as family_members_avg_3y_avg,max(c.family_members_avg) over w_3y as family_members_avg_3y_max,min(c.family_members_avg) over w_3y as family_members_avg_3y_min,avg(a.overage2_bool) over w_1y as overage2_bool_1y_avg,max(a.overage2_bool) over w_1y as overage2_bool_1y_max,min(a.overage2_bool) over w_1y as overage2_bool_1y_min,avg(a.overage2_bool) over w_2y as overage2_bool_2y_avg,max(a.overage2_bool) over w_2y as overage2_bool_2y_max,min(a.overage2_bool) over w_2y as overage2_bool_2y_min,avg(a.overage2_bool) over w_3y as overage2_bool_3y_avg,max(a.overage2_bool) over w_3y as overage2_bool_3y_max,min(a.overage2_bool) over w_3y as overage2_bool_3y_min,avg(a.age) over w_1y as age_1y_avg,max(a.age) over w_1y as age_1y_max,min(a.age) over w_1y as age_1y_min,avg(a.age) over w_2y as age_2y_avg,max(a.age) over w_2y as age_2y_max,min(a.age) over w_2y as age_2y_min,avg(a.age) over w_3y as age_3y_avg,max(a.age) over w_3y as age_3y_max,min(a.age) over w_3y as age_3y_min,avg(c.age_max) over w_1y as age_max_1y_avg,max(c.age_max) over w_1y as age_max_1y_max,min(c.age_max) over w_1y as age_max_1y_min,avg(c.age_max) over w_2y as age_max_2y_avg,max(c.age_max) over w_2y as age_max_2y_max,min(c.age_max) over w_2y as age_max_2y_min,avg(c.age_max) over w_3y as age_max_3y_avg,max(c.age_max) over w_3y as age_max_3y_max,min(c.age_max) over w_3y as age_max_3y_min,avg(c.grado_code_avg) over w_1y as grado_code_avg_1y_avg,max(c.grado_code_avg) over w_1y as grado_code_avg_1y_max,min(c.grado_code_avg) over w_1y as grado_code_avg_1y_min,avg(c.grado_code_avg) over w_2y as grado_code_avg_2y_avg,max(c.grado_code_avg) over w_2y as grado_code_avg_2y_max,min(c.grado_code_avg) over w_2y as grado_code_avg_2y_min,avg(c.grado_code_avg) over w_3y as grado_code_avg_3y_avg,max(c.grado_code_avg) over w_3y as grado_code_avg_3y_max,min(c.grado_code_avg) over w_3y as grado_code_avg_3y_min,avg(c.school_index_min) over w_1y as school_index_min_1y_avg,max(c.school_index_min) over w_1y as school_index_min_1y_max,min(c.school_index_min) over w_1y as school_index_min_1y_min,avg(c.school_index_min) over w_2y as school_index_min_2y_avg,max(c.school_index_min) over w_2y as school_index_min_2y_max,min(c.school_index_min) over w_2y as school_index_min_2y_min,avg(c.school_index_min) over w_3y as school_index_min_3y_avg,max(c.school_index_min) over w_3y as school_index_min_3y_max,min(c.school_index_min) over w_3y as school_index_min_3y_min,avg(c.school_classrooms_max) over w_1y as school_classrooms_max_1y_avg,max(c.school_classrooms_max) over w_1y as school_classrooms_max_1y_max,min(c.school_classrooms_max) over w_1y as school_classrooms_max_1y_min,avg(c.school_classrooms_max) over w_2y as school_classrooms_max_2y_avg,max(c.school_classrooms_max) over w_2y as school_classrooms_max_2y_max,min(c.school_classrooms_max) over w_2y as school_classrooms_max_2y_min,avg(c.school_classrooms_max) over w_3y as school_classrooms_max_3y_avg,max(c.school_classrooms_max) over w_3y as school_classrooms_max_3y_max,min(c.school_classrooms_max) over w_3y as school_classrooms_max_3y_min,avg(c.school_toiletseptic_avg) over w_1y as school_toiletseptic_avg_1y_avg,max(c.school_toiletseptic_avg) over w_1y as school_toiletseptic_avg_1y_max,min(c.school_toiletseptic_avg) over w_1y as school_toiletseptic_avg_1y_min,avg(c.school_toiletseptic_avg) over w_2y as school_toiletseptic_avg_2y_avg,max(c.school_toiletseptic_avg) over w_2y as school_toiletseptic_avg_2y_max,min(c.school_toiletseptic_avg) over w_2y as school_toiletseptic_avg_2y_min,avg(c.school_toiletseptic_avg) over w_3y as school_toiletseptic_avg_3y_avg,max(c.school_toiletseptic_avg) over w_3y as school_toiletseptic_avg_3y_max,min(c.school_toiletseptic_avg) over w_3y as school_toiletseptic_avg_3y_min,array_to_string(array_agg(c.school_program_safe_school) over w_1y, ',')  as school_program_safe_school_1y,array_length(string_to_array(array_to_string(array_agg(c.school_program_safe_school) over w_1y, ','), ','), 1) as school_program_safe_school_1y_count,array_to_string(array_agg(c.school_program_safe_school) over w_2y, ',')  as school_program_safe_school_2y,array_length(string_to_array(array_to_string(array_agg(c.school_program_safe_school) over w_2y, ','), ','), 1) as school_program_safe_school_2y_count,array_to_string(array_agg(c.school_program_safe_school) over w_3y, ',')  as school_program_safe_school_3y,array_length(string_to_array(array_to_string(array_agg(c.school_program_safe_school) over w_3y, ','), ','), 1) as school_program_safe_school_3y_count,avg(c.school_toiletsepticworks_min) over w_1y as school_toiletsepticworks_min_1y_avg,max(c.school_toiletsepticworks_min) over w_1y as school_toiletsepticworks_min_1y_max,min(c.school_toiletsepticworks_min) over w_1y as school_toiletsepticworks_min_1y_min,avg(c.school_toiletsepticworks_min) over w_2y as school_toiletsepticworks_min_2y_avg,max(c.school_toiletsepticworks_min) over w_2y as school_toiletsepticworks_min_2y_max,min(c.school_toiletsepticworks_min) over w_2y as school_toiletsepticworks_min_2y_min,avg(c.school_toiletsepticworks_min) over w_3y as school_toiletsepticworks_min_3y_avg,max(c.school_toiletsepticworks_min) over w_3y as school_toiletsepticworks_min_3y_max,min(c.school_toiletsepticworks_min) over w_3y as school_toiletsepticworks_min_3y_min,(bool_and(c.school_owner_own_all) over w_1y)::int as school_owner_own_all_1y_all,(bool_or(c.school_owner_own_all) over w_1y)::int as school_owner_own_all_1y_any,(bool_and(c.school_owner_own_all) over w_2y)::int as school_owner_own_all_2y_all,(bool_or(c.school_owner_own_all) over w_2y)::int as school_owner_own_all_2y_any,(bool_and(c.school_owner_own_all) over w_3y)::int as school_owner_own_all_3y_all,(bool_or(c.school_owner_own_all) over w_3y)::int as school_owner_own_all_3y_any,avg(c.commute_count) over w_1y as commute_count_1y_avg,max(c.commute_count) over w_1y as commute_count_1y_max,min(c.commute_count) over w_1y as commute_count_1y_min,avg(c.commute_count) over w_2y as commute_count_2y_avg,max(c.commute_count) over w_2y as commute_count_2y_max,min(c.commute_count) over w_2y as commute_count_2y_min,avg(c.commute_count) over w_3y as commute_count_3y_avg,max(c.commute_count) over w_3y as commute_count_3y_max,min(c.commute_count) over w_3y as commute_count_3y_min,(bool_and(a.school_rural) over w_1y)::int as school_rural_1y_all,(bool_or(a.school_rural) over w_1y)::int as school_rural_1y_any,(bool_and(a.school_rural) over w_2y)::int as school_rural_2y_all,(bool_or(a.school_rural) over w_2y)::int as school_rural_2y_any,(bool_and(a.school_rural) over w_3y)::int as school_rural_3y_all,(bool_or(a.school_rural) over w_3y)::int as school_rural_3y_any,avg(c.school_toiletworks_avg) over w_1y as school_toiletworks_avg_1y_avg,max(c.school_toiletworks_avg) over w_1y as school_toiletworks_avg_1y_max,min(c.school_toiletworks_avg) over w_1y as school_toiletworks_avg_1y_min,avg(c.school_toiletworks_avg) over w_2y as school_toiletworks_avg_2y_avg,max(c.school_toiletworks_avg) over w_2y as school_toiletworks_avg_2y_max,min(c.school_toiletworks_avg) over w_2y as school_toiletworks_avg_2y_min,avg(c.school_toiletworks_avg) over w_3y as school_toiletworks_avg_3y_avg,max(c.school_toiletworks_avg) over w_3y as school_toiletworks_avg_3y_max,min(c.school_toiletworks_avg) over w_3y as school_toiletworks_avg_3y_min,avg(c.school_index_max) over w_1y as school_index_max_1y_avg,max(c.school_index_max) over w_1y as school_index_max_1y_max,min(c.school_index_max) over w_1y as school_index_max_1y_min,avg(c.school_index_max) over w_2y as school_index_max_2y_avg,max(c.school_index_max) over w_2y as school_index_max_2y_max,min(c.school_index_max) over w_2y as school_index_max_2y_min,avg(c.school_index_max) over w_3y as school_index_max_3y_avg,max(c.school_index_max) over w_3y as school_index_max_3y_max,min(c.school_index_max) over w_3y as school_index_max_3y_min,avg(c.school_classrooms_avg) over w_1y as school_classrooms_avg_1y_avg,max(c.school_classrooms_avg) over w_1y as school_classrooms_avg_1y_max,min(c.school_classrooms_avg) over w_1y as school_classrooms_avg_1y_min,avg(c.school_classrooms_avg) over w_2y as school_classrooms_avg_2y_avg,max(c.school_classrooms_avg) over w_2y as school_classrooms_avg_2y_max,min(c.school_classrooms_avg) over w_2y as school_classrooms_avg_2y_min,avg(c.school_classrooms_avg) over w_3y as school_classrooms_avg_3y_avg,max(c.school_classrooms_avg) over w_3y as school_classrooms_avg_3y_max,min(c.school_classrooms_avg) over w_3y as school_classrooms_avg_3y_min,(bool_and(c.school_prostitution_all) over w_1y)::int as school_prostitution_all_1y_all,(bool_or(c.school_prostitution_all) over w_1y)::int as school_prostitution_all_1y_any,(bool_and(c.school_prostitution_all) over w_2y)::int as school_prostitution_all_2y_all,(bool_or(c.school_prostitution_all) over w_2y)::int as school_prostitution_all_2y_any,(bool_and(c.school_prostitution_all) over w_3y)::int as school_prostitution_all_3y_all,(bool_or(c.school_prostitution_all) over w_3y)::int as school_prostitution_all_3y_any,avg(c.school_teachers_avg) over w_1y as school_teachers_avg_1y_avg,max(c.school_teachers_avg) over w_1y as school_teachers_avg_1y_max,min(c.school_teachers_avg) over w_1y as school_teachers_avg_1y_min,avg(c.school_teachers_avg) over w_2y as school_teachers_avg_2y_avg,max(c.school_teachers_avg) over w_2y as school_teachers_avg_2y_max,min(c.school_teachers_avg) over w_2y as school_teachers_avg_2y_min,avg(c.school_teachers_avg) over w_3y as school_teachers_avg_3y_avg,max(c.school_teachers_avg) over w_3y as school_teachers_avg_3y_max,min(c.school_teachers_avg) over w_3y as school_teachers_avg_3y_min,avg(a.repeats_bool) over w_1y as repeats_bool_1y_avg,max(a.repeats_bool) over w_1y as repeats_bool_1y_max,min(a.repeats_bool) over w_1y as repeats_bool_1y_min,avg(a.repeats_bool) over w_2y as repeats_bool_2y_avg,max(a.repeats_bool) over w_2y as repeats_bool_2y_max,min(a.repeats_bool) over w_2y as repeats_bool_2y_min,avg(a.repeats_bool) over w_3y as repeats_bool_3y_avg,max(a.repeats_bool) over w_3y as repeats_bool_3y_max,min(a.repeats_bool) over w_3y as repeats_bool_3y_min,avg(c.school_difference_avg) over w_1y as school_difference_avg_1y_avg,max(c.school_difference_avg) over w_1y as school_difference_avg_1y_max,min(c.school_difference_avg) over w_1y as school_difference_avg_1y_min,avg(c.school_difference_avg) over w_2y as school_difference_avg_2y_avg,max(c.school_difference_avg) over w_2y as school_difference_avg_2y_max,min(c.school_difference_avg) over w_2y as school_difference_avg_2y_min,avg(c.school_difference_avg) over w_3y as school_difference_avg_3y_avg,max(c.school_difference_avg) over w_3y as school_difference_avg_3y_max,min(c.school_difference_avg) over w_3y as school_difference_avg_3y_min,array_to_string(array_agg(a.commute) over w_1y, ',')  as commute_1y,array_length(string_to_array(array_to_string(array_agg(a.commute) over w_1y, ','), ','), 1) as commute_1y_count,array_to_string(array_agg(a.commute) over w_2y, ',')  as commute_2y,array_length(string_to_array(array_to_string(array_agg(a.commute) over w_2y, ','), ','), 1) as commute_2y_count,array_to_string(array_agg(a.commute) over w_3y, ',')  as commute_3y,array_length(string_to_array(array_to_string(array_agg(a.commute) over w_3y, ','), ','), 1) as commute_3y_count,(bool_and(c.school_native_any) over w_1y)::int as school_native_any_1y_all,(bool_or(c.school_native_any) over w_1y)::int as school_native_any_1y_any,(bool_and(c.school_native_any) over w_2y)::int as school_native_any_2y_all,(bool_or(c.school_native_any) over w_2y)::int as school_native_any_2y_any,(bool_and(c.school_native_any) over w_3y)::int as school_native_any_3y_all,(bool_or(c.school_native_any) over w_3y)::int as school_native_any_3y_any,avg(c.school_municipio_count) over w_1y as school_municipio_count_1y_avg,max(c.school_municipio_count) over w_1y as school_municipio_count_1y_max,min(c.school_municipio_count) over w_1y as school_municipio_count_1y_min,avg(c.school_municipio_count) over w_2y as school_municipio_count_2y_avg,max(c.school_municipio_count) over w_2y as school_municipio_count_2y_max,min(c.school_municipio_count) over w_2y as school_municipio_count_2y_min,avg(c.school_municipio_count) over w_3y as school_municipio_count_3y_avg,max(c.school_municipio_count) over w_3y as school_municipio_count_3y_max,min(c.school_municipio_count) over w_3y as school_municipio_count_3y_min,avg(c.school_toiletseptic_max) over w_1y as school_toiletseptic_max_1y_avg,max(c.school_toiletseptic_max) over w_1y as school_toiletseptic_max_1y_max,min(c.school_toiletseptic_max) over w_1y as school_toiletseptic_max_1y_min,avg(c.school_toiletseptic_max) over w_2y as school_toiletseptic_max_2y_avg,max(c.school_toiletseptic_max) over w_2y as school_toiletseptic_max_2y_max,min(c.school_toiletseptic_max) over w_2y as school_toiletseptic_max_2y_min,avg(c.school_toiletseptic_max) over w_3y as school_toiletseptic_max_3y_avg,max(c.school_toiletseptic_max) over w_3y as school_toiletseptic_max_3y_max,min(c.school_toiletseptic_max) over w_3y as school_toiletseptic_max_3y_min,avg(c.school_toiletworks_min) over w_1y as school_toiletworks_min_1y_avg,max(c.school_toiletworks_min) over w_1y as school_toiletworks_min_1y_max,min(c.school_toiletworks_min) over w_1y as school_toiletworks_min_1y_min,avg(c.school_toiletworks_min) over w_2y as school_toiletworks_min_2y_avg,max(c.school_toiletworks_min) over w_2y as school_toiletworks_min_2y_max,min(c.school_toiletworks_min) over w_2y as school_toiletworks_min_2y_min,avg(c.school_toiletworks_min) over w_3y as school_toiletworks_min_3y_avg,max(c.school_toiletworks_min) over w_3y as school_toiletworks_min_3y_max,min(c.school_toiletworks_min) over w_3y as school_toiletworks_min_3y_min,avg(c.school_program_safe_school_count_avg) over w_1y as school_program_safe_school_count_avg_1y_avg,max(c.school_program_safe_school_count_avg) over w_1y as school_program_safe_school_count_avg_1y_max,min(c.school_program_safe_school_count_avg) over w_1y as school_program_safe_school_count_avg_1y_min,avg(c.school_program_safe_school_count_avg) over w_2y as school_program_safe_school_count_avg_2y_avg,max(c.school_program_safe_school_count_avg) over w_2y as school_program_safe_school_count_avg_2y_max,min(c.school_program_safe_school_count_avg) over w_2y as school_program_safe_school_count_avg_2y_min,avg(c.school_program_safe_school_count_avg) over w_3y as school_program_safe_school_count_avg_3y_avg,max(c.school_program_safe_school_count_avg) over w_3y as school_program_safe_school_count_avg_3y_max,min(c.school_program_safe_school_count_avg) over w_3y as school_program_safe_school_count_avg_3y_min,avg(a.overage2) over w_1y as overage2_1y_avg,max(a.overage2) over w_1y as overage2_1y_max,min(a.overage2) over w_1y as overage2_1y_min,avg(a.overage2) over w_2y as overage2_2y_avg,max(a.overage2) over w_2y as overage2_2y_max,min(a.overage2) over w_2y as overage2_2y_min,avg(a.overage2) over w_3y as overage2_3y_avg,max(a.overage2) over w_3y as overage2_3y_max,min(a.overage2) over w_3y as overage2_3y_min,(bool_and(c.school_owner_borrow_all) over w_1y)::int as school_owner_borrow_all_1y_all,(bool_or(c.school_owner_borrow_all) over w_1y)::int as school_owner_borrow_all_1y_any,(bool_and(c.school_owner_borrow_all) over w_2y)::int as school_owner_borrow_all_2y_all,(bool_or(c.school_owner_borrow_all) over w_2y)::int as school_owner_borrow_all_2y_any,(bool_and(c.school_owner_borrow_all) over w_3y)::int as school_owner_borrow_all_3y_all,(bool_or(c.school_owner_borrow_all) over w_3y)::int as school_owner_borrow_all_3y_any,avg(c.grado_code_max) over w_1y as grado_code_max_1y_avg,max(c.grado_code_max) over w_1y as grado_code_max_1y_max,min(c.grado_code_max) over w_1y as grado_code_max_1y_min,avg(c.grado_code_max) over w_2y as grado_code_max_2y_avg,max(c.grado_code_max) over w_2y as grado_code_max_2y_max,min(c.grado_code_max) over w_2y as grado_code_max_2y_min,avg(c.grado_code_max) over w_3y as grado_code_max_3y_avg,max(c.grado_code_max) over w_3y as grado_code_max_3y_max,min(c.grado_code_max) over w_3y as grado_code_max_3y_min,avg(a.student_female) over w_1y as student_female_1y_avg,max(a.student_female) over w_1y as student_female_1y_max,min(a.student_female) over w_1y as student_female_1y_min,avg(a.student_female) over w_2y as student_female_2y_avg,max(a.student_female) over w_2y as student_female_2y_max,min(a.student_female) over w_2y as student_female_2y_min,avg(a.student_female) over w_3y as student_female_3y_avg,max(a.student_female) over w_3y as student_female_3y_max,min(a.student_female) over w_3y as student_female_3y_min,(bool_and(c.school_program_pase_all) over w_1y)::int as school_program_pase_all_1y_all,(bool_or(c.school_program_pase_all) over w_1y)::int as school_program_pase_all_1y_any,(bool_and(c.school_program_pase_all) over w_2y)::int as school_program_pase_all_2y_all,(bool_or(c.school_program_pase_all) over w_2y)::int as school_program_pase_all_2y_any,(bool_and(c.school_program_pase_all) over w_3y)::int as school_program_pase_all_3y_all,(bool_or(c.school_program_pase_all) over w_3y)::int as school_program_pase_all_3y_any,(bool_and(c.school_rape2_any) over w_1y)::int as school_rape2_any_1y_all,(bool_or(c.school_rape2_any) over w_1y)::int as school_rape2_any_1y_any,(bool_and(c.school_rape2_any) over w_2y)::int as school_rape2_any_2y_all,(bool_or(c.school_rape2_any) over w_2y)::int as school_rape2_any_2y_any,(bool_and(c.school_rape2_any) over w_3y)::int as school_rape2_any_3y_all,(bool_or(c.school_rape2_any) over w_3y)::int as school_rape2_any_3y_any,(bool_and(c.school_electricity_any) over w_1y)::int as school_electricity_any_1y_all,(bool_or(c.school_electricity_any) over w_1y)::int as school_electricity_any_1y_any,(bool_and(c.school_electricity_any) over w_2y)::int as school_electricity_any_2y_all,(bool_or(c.school_electricity_any) over w_2y)::int as school_electricity_any_2y_any,(bool_and(c.school_electricity_any) over w_3y)::int as school_electricity_any_3y_all,(bool_or(c.school_electricity_any) over w_3y)::int as school_electricity_any_3y_any,avg(a.school_difference) over w_1y as school_difference_1y_avg,max(a.school_difference) over w_1y as school_difference_1y_max,min(a.school_difference) over w_1y as school_difference_1y_min,avg(a.school_difference) over w_2y as school_difference_2y_avg,max(a.school_difference) over w_2y as school_difference_2y_max,min(a.school_difference) over w_2y as school_difference_2y_min,avg(a.school_difference) over w_3y as school_difference_3y_avg,max(a.school_difference) over w_3y as school_difference_3y_max,min(a.school_difference) over w_3y as school_difference_3y_min,(bool_and(c.school_owner_lease_all) over w_1y)::int as school_owner_lease_all_1y_all,(bool_or(c.school_owner_lease_all) over w_1y)::int as school_owner_lease_all_1y_any,(bool_and(c.school_owner_lease_all) over w_2y)::int as school_owner_lease_all_2y_all,(bool_or(c.school_owner_lease_all) over w_2y)::int as school_owner_lease_all_2y_any,(bool_and(c.school_owner_lease_all) over w_3y)::int as school_owner_lease_all_3y_all,(bool_or(c.school_owner_lease_all) over w_3y)::int as school_owner_lease_all_3y_any,(bool_and(c.school_owner_own_any) over w_1y)::int as school_owner_own_any_1y_all,(bool_or(c.school_owner_own_any) over w_1y)::int as school_owner_own_any_1y_any,(bool_and(c.school_owner_own_any) over w_2y)::int as school_owner_own_any_2y_all,(bool_or(c.school_owner_own_any) over w_2y)::int as school_owner_own_any_2y_any,(bool_and(c.school_owner_own_any) over w_3y)::int as school_owner_own_any_3y_all,(bool_or(c.school_owner_own_any) over w_3y)::int as school_owner_own_any_3y_any,avg(c.school_toilet_min) over w_1y as school_toilet_min_1y_avg,max(c.school_toilet_min) over w_1y as school_toilet_min_1y_max,min(c.school_toilet_min) over w_1y as school_toilet_min_1y_min,avg(c.school_toilet_min) over w_2y as school_toilet_min_2y_avg,max(c.school_toilet_min) over w_2y as school_toilet_min_2y_max,min(c.school_toilet_min) over w_2y as school_toilet_min_2y_min,avg(c.school_toilet_min) over w_3y as school_toilet_min_3y_avg,max(c.school_toilet_min) over w_3y as school_toilet_min_3y_max,min(c.school_toilet_min) over w_3y as school_toilet_min_3y_min,array_to_string(array_agg(a.municipio) over w_1y, ',')  as municipio_1y,array_length(string_to_array(array_to_string(array_agg(a.municipio) over w_1y, ','), ','), 1) as municipio_1y_count,array_to_string(array_agg(a.municipio) over w_2y, ',')  as municipio_2y,array_length(string_to_array(array_to_string(array_agg(a.municipio) over w_2y, ','), ','), 1) as municipio_2y_count,array_to_string(array_agg(a.municipio) over w_3y, ',')  as municipio_3y,array_length(string_to_array(array_to_string(array_agg(a.municipio) over w_3y, ','), ','), 1) as municipio_3y_count,(bool_and(c.school_native_all) over w_1y)::int as school_native_all_1y_all,(bool_or(c.school_native_all) over w_1y)::int as school_native_all_1y_any,(bool_and(c.school_native_all) over w_2y)::int as school_native_all_2y_all,(bool_or(c.school_native_all) over w_2y)::int as school_native_all_2y_any,(bool_and(c.school_native_all) over w_3y)::int as school_native_all_3y_all,(bool_or(c.school_native_all) over w_3y)::int as school_native_all_3y_any,avg(c.school_toiletpit_max) over w_1y as school_toiletpit_max_1y_avg,max(c.school_toiletpit_max) over w_1y as school_toiletpit_max_1y_max,min(c.school_toiletpit_max) over w_1y as school_toiletpit_max_1y_min,avg(c.school_toiletpit_max) over w_2y as school_toiletpit_max_2y_avg,max(c.school_toiletpit_max) over w_2y as school_toiletpit_max_2y_max,min(c.school_toiletpit_max) over w_2y as school_toiletpit_max_2y_min,avg(c.school_toiletpit_max) over w_3y as school_toiletpit_max_3y_avg,max(c.school_toiletpit_max) over w_3y as school_toiletpit_max_3y_max,min(c.school_toiletpit_max) over w_3y as school_toiletpit_max_3y_min,(bool_and(c.school_rural_all) over w_1y)::int as school_rural_all_1y_all,(bool_or(c.school_rural_all) over w_1y)::int as school_rural_all_1y_any,(bool_and(c.school_rural_all) over w_2y)::int as school_rural_all_2y_all,(bool_or(c.school_rural_all) over w_2y)::int as school_rural_all_2y_any,(bool_and(c.school_rural_all) over w_3y)::int as school_rural_all_3y_all,(bool_or(c.school_rural_all) over w_3y)::int as school_rural_all_3y_any,(bool_and(c.school_prostitution_any) over w_1y)::int as school_prostitution_any_1y_all,(bool_or(c.school_prostitution_any) over w_1y)::int as school_prostitution_any_1y_any,(bool_and(c.school_prostitution_any) over w_2y)::int as school_prostitution_any_2y_all,(bool_or(c.school_prostitution_any) over w_2y)::int as school_prostitution_any_2y_any,(bool_and(c.school_prostitution_any) over w_3y)::int as school_prostitution_any_3y_all,(bool_or(c.school_prostitution_any) over w_3y)::int as school_prostitution_any_3y_any,avg(c.school_toiletpitworks_avg) over w_1y as school_toiletpitworks_avg_1y_avg,max(c.school_toiletpitworks_avg) over w_1y as school_toiletpitworks_avg_1y_max,min(c.school_toiletpitworks_avg) over w_1y as school_toiletpitworks_avg_1y_min,avg(c.school_toiletpitworks_avg) over w_2y as school_toiletpitworks_avg_2y_avg,max(c.school_toiletpitworks_avg) over w_2y as school_toiletpitworks_avg_2y_max,min(c.school_toiletpitworks_avg) over w_2y as school_toiletpitworks_avg_2y_min,avg(c.school_toiletpitworks_avg) over w_3y as school_toiletpitworks_avg_3y_avg,max(c.school_toiletpitworks_avg) over w_3y as school_toiletpitworks_avg_3y_max,min(c.school_toiletpitworks_avg) over w_3y as school_toiletpitworks_avg_3y_min,avg(a.repeats) over w_1y as repeats_1y_avg,max(a.repeats) over w_1y as repeats_1y_max,min(a.repeats) over w_1y as repeats_1y_min,avg(a.repeats) over w_2y as repeats_2y_avg,max(a.repeats) over w_2y as repeats_2y_max,min(a.repeats) over w_2y as repeats_2y_min,avg(a.repeats) over w_3y as repeats_3y_avg,max(a.repeats) over w_3y as repeats_3y_max,min(a.repeats) over w_3y as repeats_3y_min,avg(c.school_toiletpitworks_max) over w_1y as school_toiletpitworks_max_1y_avg,max(c.school_toiletpitworks_max) over w_1y as school_toiletpitworks_max_1y_max,min(c.school_toiletpitworks_max) over w_1y as school_toiletpitworks_max_1y_min,avg(c.school_toiletpitworks_max) over w_2y as school_toiletpitworks_max_2y_avg,max(c.school_toiletpitworks_max) over w_2y as school_toiletpitworks_max_2y_max,min(c.school_toiletpitworks_max) over w_2y as school_toiletpitworks_max_2y_min,avg(c.school_toiletpitworks_max) over w_3y as school_toiletpitworks_max_3y_avg,max(c.school_toiletpitworks_max) over w_3y as school_toiletpitworks_max_3y_max,min(c.school_toiletpitworks_max) over w_3y as school_toiletpitworks_max_3y_min,(bool_and(c.school_rape_all) over w_1y)::int as school_rape_all_1y_all,(bool_or(c.school_rape_all) over w_1y)::int as school_rape_all_1y_any,(bool_and(c.school_rape_all) over w_2y)::int as school_rape_all_2y_all,(bool_or(c.school_rape_all) over w_2y)::int as school_rape_all_2y_any,(bool_and(c.school_rape_all) over w_3y)::int as school_rape_all_3y_all,(bool_or(c.school_rape_all) over w_3y)::int as school_rape_all_3y_any,avg(a.family_members) over w_1y as family_members_1y_avg,max(a.family_members) over w_1y as family_members_1y_max,min(a.family_members) over w_1y as family_members_1y_min,avg(a.family_members) over w_2y as family_members_2y_avg,max(a.family_members) over w_2y as family_members_2y_max,min(a.family_members) over w_2y as family_members_2y_min,avg(a.family_members) over w_3y as family_members_3y_avg,max(a.family_members) over w_3y as family_members_3y_max,min(a.family_members) over w_3y as family_members_3y_min,avg(a.school_toilet) over w_1y as school_toilet_1y_avg,max(a.school_toilet) over w_1y as school_toilet_1y_max,min(a.school_toilet) over w_1y as school_toilet_1y_min,avg(a.school_toilet) over w_2y as school_toilet_2y_avg,max(a.school_toilet) over w_2y as school_toilet_2y_max,min(a.school_toilet) over w_2y as school_toilet_2y_min,avg(a.school_toilet) over w_3y as school_toilet_3y_avg,max(a.school_toilet) over w_3y as school_toilet_3y_max,min(a.school_toilet) over w_3y as school_toilet_3y_min,avg(c.school_teachers_min) over w_1y as school_teachers_min_1y_avg,max(c.school_teachers_min) over w_1y as school_teachers_min_1y_max,min(c.school_teachers_min) over w_1y as school_teachers_min_1y_min,avg(c.school_teachers_min) over w_2y as school_teachers_min_2y_avg,max(c.school_teachers_min) over w_2y as school_teachers_min_2y_max,min(c.school_teachers_min) over w_2y as school_teachers_min_2y_min,avg(c.school_teachers_min) over w_3y as school_teachers_min_3y_avg,max(c.school_teachers_min) over w_3y as school_teachers_min_3y_max,min(c.school_teachers_min) over w_3y as school_teachers_min_3y_min,array_to_string(array_agg(a.school_municipio) over w_1y, ',')  as school_municipio_1y,array_length(string_to_array(array_to_string(array_agg(a.school_municipio) over w_1y, ','), ','), 1) as school_municipio_1y_count,array_to_string(array_agg(a.school_municipio) over w_2y, ',')  as school_municipio_2y,array_length(string_to_array(array_to_string(array_agg(a.school_municipio) over w_2y, ','), ','), 1) as school_municipio_2y_count,array_to_string(array_agg(a.school_municipio) over w_3y, ',')  as school_municipio_3y,array_length(string_to_array(array_to_string(array_agg(a.school_municipio) over w_3y, ','), ','), 1) as school_municipio_3y_count,array_to_string(array_agg(c.school) over w_1y, ',')  as school_1y,array_length(string_to_array(array_to_string(array_agg(c.school) over w_1y, ','), ','), 1) as school_1y_count,array_to_string(array_agg(c.school) over w_2y, ',')  as school_2y,array_length(string_to_array(array_to_string(array_agg(c.school) over w_2y, ','), ','), 1) as school_2y_count,array_to_string(array_agg(c.school) over w_3y, ',')  as school_3y,array_length(string_to_array(array_to_string(array_agg(c.school) over w_3y, ','), ','), 1) as school_3y_count,(bool_and(c.school_owner_borrow_any) over w_1y)::int as school_owner_borrow_any_1y_all,(bool_or(c.school_owner_borrow_any) over w_1y)::int as school_owner_borrow_any_1y_any,(bool_and(c.school_owner_borrow_any) over w_2y)::int as school_owner_borrow_any_2y_all,(bool_or(c.school_owner_borrow_any) over w_2y)::int as school_owner_borrow_any_2y_any,(bool_and(c.school_owner_borrow_any) over w_3y)::int as school_owner_borrow_any_3y_all,(bool_or(c.school_owner_borrow_any) over w_3y)::int as school_owner_borrow_any_3y_any,avg(a.school_teachers) over w_1y as school_teachers_1y_avg,max(a.school_teachers) over w_1y as school_teachers_1y_max,min(a.school_teachers) over w_1y as school_teachers_1y_min,avg(a.school_teachers) over w_2y as school_teachers_2y_avg,max(a.school_teachers) over w_2y as school_teachers_2y_max,min(a.school_teachers) over w_2y as school_teachers_2y_min,avg(a.school_teachers) over w_3y as school_teachers_3y_avg,max(a.school_teachers) over w_3y as school_teachers_3y_max,min(a.school_teachers) over w_3y as school_teachers_3y_min,(bool_and(c.school_rape2_all) over w_1y)::int as school_rape2_all_1y_all,(bool_or(c.school_rape2_all) over w_1y)::int as school_rape2_all_1y_any,(bool_and(c.school_rape2_all) over w_2y)::int as school_rape2_all_2y_all,(bool_or(c.school_rape2_all) over w_2y)::int as school_rape2_all_2y_any,(bool_and(c.school_rape2_all) over w_3y)::int as school_rape2_all_3y_all,(bool_or(c.school_rape2_all) over w_3y)::int as school_rape2_all_3y_any,avg(c.school_mismatch_max) over w_1y as school_mismatch_max_1y_avg,max(c.school_mismatch_max) over w_1y as school_mismatch_max_1y_max,min(c.school_mismatch_max) over w_1y as school_mismatch_max_1y_min,avg(c.school_mismatch_max) over w_2y as school_mismatch_max_2y_avg,max(c.school_mismatch_max) over w_2y as school_mismatch_max_2y_max,min(c.school_mismatch_max) over w_2y as school_mismatch_max_2y_min,avg(c.school_mismatch_max) over w_3y as school_mismatch_max_3y_avg,max(c.school_mismatch_max) over w_3y as school_mismatch_max_3y_max,min(c.school_mismatch_max) over w_3y as school_mismatch_max_3y_min,(bool_and(c.school_public_any) over w_1y)::int as school_public_any_1y_all,(bool_or(c.school_public_any) over w_1y)::int as school_public_any_1y_any,(bool_and(c.school_public_any) over w_2y)::int as school_public_any_2y_all,(bool_or(c.school_public_any) over w_2y)::int as school_public_any_2y_any,(bool_and(c.school_public_any) over w_3y)::int as school_public_any_3y_all,(bool_or(c.school_public_any) over w_3y)::int as school_public_any_3y_any,(bool_and(c.school_vaso_de_leche_any) over w_1y)::int as school_vaso_de_leche_any_1y_all,(bool_or(c.school_vaso_de_leche_any) over w_1y)::int as school_vaso_de_leche_any_1y_any,(bool_and(c.school_vaso_de_leche_any) over w_2y)::int as school_vaso_de_leche_any_2y_all,(bool_or(c.school_vaso_de_leche_any) over w_2y)::int as school_vaso_de_leche_any_2y_any,(bool_and(c.school_vaso_de_leche_any) over w_3y)::int as school_vaso_de_leche_any_3y_all,(bool_or(c.school_vaso_de_leche_any) over w_3y)::int as school_vaso_de_leche_any_3y_any,avg(c.school_difference_min) over w_1y as school_difference_min_1y_avg,max(c.school_difference_min) over w_1y as school_difference_min_1y_max,min(c.school_difference_min) over w_1y as school_difference_min_1y_min,avg(c.school_difference_min) over w_2y as school_difference_min_2y_avg,max(c.school_difference_min) over w_2y as school_difference_min_2y_max,min(c.school_difference_min) over w_2y as school_difference_min_2y_min,avg(c.school_difference_min) over w_3y as school_difference_min_3y_avg,max(c.school_difference_min) over w_3y as school_difference_min_3y_max,min(c.school_difference_min) over w_3y as school_difference_min_3y_min,(bool_and(c.school_public_all) over w_1y)::int as school_public_all_1y_all,(bool_or(c.school_public_all) over w_1y)::int as school_public_all_1y_any,(bool_and(c.school_public_all) over w_2y)::int as school_public_all_2y_all,(bool_or(c.school_public_all) over w_2y)::int as school_public_all_2y_any,(bool_and(c.school_public_all) over w_3y)::int as school_public_all_3y_all,(bool_or(c.school_public_all) over w_3y)::int as school_public_all_3y_any,avg(c.school_toiletpitworks_min) over w_1y as school_toiletpitworks_min_1y_avg,max(c.school_toiletpitworks_min) over w_1y as school_toiletpitworks_min_1y_max,min(c.school_toiletpitworks_min) over w_1y as school_toiletpitworks_min_1y_min,avg(c.school_toiletpitworks_min) over w_2y as school_toiletpitworks_min_2y_avg,max(c.school_toiletpitworks_min) over w_2y as school_toiletpitworks_min_2y_max,min(c.school_toiletpitworks_min) over w_2y as school_toiletpitworks_min_2y_min,avg(c.school_toiletpitworks_min) over w_3y as school_toiletpitworks_min_3y_avg,max(c.school_toiletpitworks_min) over w_3y as school_toiletpitworks_min_3y_max,min(c.school_toiletpitworks_min) over w_3y as school_toiletpitworks_min_3y_min,avg(c.school_toiletsepticworks_max) over w_1y as school_toiletsepticworks_max_1y_avg,max(c.school_toiletsepticworks_max) over w_1y as school_toiletsepticworks_max_1y_max,min(c.school_toiletsepticworks_max) over w_1y as school_toiletsepticworks_max_1y_min,avg(c.school_toiletsepticworks_max) over w_2y as school_toiletsepticworks_max_2y_avg,max(c.school_toiletsepticworks_max) over w_2y as school_toiletsepticworks_max_2y_max,min(c.school_toiletsepticworks_max) over w_2y as school_toiletsepticworks_max_2y_min,avg(c.school_toiletsepticworks_max) over w_3y as school_toiletsepticworks_max_3y_avg,max(c.school_toiletsepticworks_max) over w_3y as school_toiletsepticworks_max_3y_max,min(c.school_toiletsepticworks_max) over w_3y as school_toiletsepticworks_max_3y_min,avg(c.school_index_avg) over w_1y as school_index_avg_1y_avg,max(c.school_index_avg) over w_1y as school_index_avg_1y_max,min(c.school_index_avg) over w_1y as school_index_avg_1y_min,avg(c.school_index_avg) over w_2y as school_index_avg_2y_avg,max(c.school_index_avg) over w_2y as school_index_avg_2y_max,min(c.school_index_avg) over w_2y as school_index_avg_2y_min,avg(c.school_index_avg) over w_3y as school_index_avg_3y_avg,max(c.school_index_avg) over w_3y as school_index_avg_3y_max,min(c.school_index_avg) over w_3y as school_index_avg_3y_min,(bool_and(c.school_vaso_de_leche_all) over w_1y)::int as school_vaso_de_leche_all_1y_all,(bool_or(c.school_vaso_de_leche_all) over w_1y)::int as school_vaso_de_leche_all_1y_any,(bool_and(c.school_vaso_de_leche_all) over w_2y)::int as school_vaso_de_leche_all_2y_all,(bool_or(c.school_vaso_de_leche_all) over w_2y)::int as school_vaso_de_leche_all_2y_any,(bool_and(c.school_vaso_de_leche_all) over w_3y)::int as school_vaso_de_leche_all_3y_all,(bool_or(c.school_vaso_de_leche_all) over w_3y)::int as school_vaso_de_leche_all_3y_any,(bool_and(c.school_rape_any) over w_1y)::int as school_rape_any_1y_all,(bool_or(c.school_rape_any) over w_1y)::int as school_rape_any_1y_any,(bool_and(c.school_rape_any) over w_2y)::int as school_rape_any_2y_all,(bool_or(c.school_rape_any) over w_2y)::int as school_rape_any_2y_any,(bool_and(c.school_rape_any) over w_3y)::int as school_rape_any_3y_all,(bool_or(c.school_rape_any) over w_3y)::int as school_rape_any_3y_any,(bool_and(c.school_owner_other_any) over w_1y)::int as school_owner_other_any_1y_all,(bool_or(c.school_owner_other_any) over w_1y)::int as school_owner_other_any_1y_any,(bool_and(c.school_owner_other_any) over w_2y)::int as school_owner_other_any_2y_all,(bool_or(c.school_owner_other_any) over w_2y)::int as school_owner_other_any_2y_any,(bool_and(c.school_owner_other_any) over w_3y)::int as school_owner_other_any_3y_all,(bool_or(c.school_owner_other_any) over w_3y)::int as school_owner_other_any_3y_any,avg(c.school_toiletseptic_min) over w_1y as school_toiletseptic_min_1y_avg,max(c.school_toiletseptic_min) over w_1y as school_toiletseptic_min_1y_max,min(c.school_toiletseptic_min) over w_1y as school_toiletseptic_min_1y_min,avg(c.school_toiletseptic_min) over w_2y as school_toiletseptic_min_2y_avg,max(c.school_toiletseptic_min) over w_2y as school_toiletseptic_min_2y_max,min(c.school_toiletseptic_min) over w_2y as school_toiletseptic_min_2y_min,avg(c.school_toiletseptic_min) over w_3y as school_toiletseptic_min_3y_avg,max(c.school_toiletseptic_min) over w_3y as school_toiletseptic_min_3y_max,min(c.school_toiletseptic_min) over w_3y as school_toiletseptic_min_3y_min,array_to_string(array_agg(a.departamento) over w_1y, ',')  as departamento_1y,array_length(string_to_array(array_to_string(array_agg(a.departamento) over w_1y, ','), ','), 1) as departamento_1y_count,array_to_string(array_agg(a.departamento) over w_2y, ',')  as departamento_2y,array_length(string_to_array(array_to_string(array_agg(a.departamento) over w_2y, ','), ','), 1) as departamento_2y_count,array_to_string(array_agg(a.departamento) over w_3y, ',')  as departamento_3y,array_length(string_to_array(array_to_string(array_agg(a.departamento) over w_3y, ','), ','), 1) as departamento_3y_count,avg(c.school_departamento_count) over w_1y as school_departamento_count_1y_avg,max(c.school_departamento_count) over w_1y as school_departamento_count_1y_max,min(c.school_departamento_count) over w_1y as school_departamento_count_1y_min,avg(c.school_departamento_count) over w_2y as school_departamento_count_2y_avg,max(c.school_departamento_count) over w_2y as school_departamento_count_2y_max,min(c.school_departamento_count) over w_2y as school_departamento_count_2y_min,avg(c.school_departamento_count) over w_3y as school_departamento_count_3y_avg,max(c.school_departamento_count) over w_3y as school_departamento_count_3y_max,min(c.school_departamento_count) over w_3y as school_departamento_count_3y_min,avg(c.school_classrooms_min) over w_1y as school_classrooms_min_1y_avg,max(c.school_classrooms_min) over w_1y as school_classrooms_min_1y_max,min(c.school_classrooms_min) over w_1y as school_classrooms_min_1y_min,avg(c.school_classrooms_min) over w_2y as school_classrooms_min_2y_avg,max(c.school_classrooms_min) over w_2y as school_classrooms_min_2y_max,min(c.school_classrooms_min) over w_2y as school_classrooms_min_2y_min,avg(c.school_classrooms_min) over w_3y as school_classrooms_min_3y_avg,max(c.school_classrooms_min) over w_3y as school_classrooms_min_3y_max,min(c.school_classrooms_min) over w_3y as school_classrooms_min_3y_min,(bool_and(c.school_owner_loan_any) over w_1y)::int as school_owner_loan_any_1y_all,(bool_or(c.school_owner_loan_any) over w_1y)::int as school_owner_loan_any_1y_any,(bool_and(c.school_owner_loan_any) over w_2y)::int as school_owner_loan_any_2y_all,(bool_or(c.school_owner_loan_any) over w_2y)::int as school_owner_loan_any_2y_any,(bool_and(c.school_owner_loan_any) over w_3y)::int as school_owner_loan_any_3y_all,(bool_or(c.school_owner_loan_any) over w_3y)::int as school_owner_loan_any_3y_any,avg(c.school_teachers_max) over w_1y as school_teachers_max_1y_avg,max(c.school_teachers_max) over w_1y as school_teachers_max_1y_max,min(c.school_teachers_max) over w_1y as school_teachers_max_1y_min,avg(c.school_teachers_max) over w_2y as school_teachers_max_2y_avg,max(c.school_teachers_max) over w_2y as school_teachers_max_2y_max,min(c.school_teachers_max) over w_2y as school_teachers_max_2y_min,avg(c.school_teachers_max) over w_3y as school_teachers_max_3y_avg,max(c.school_teachers_max) over w_3y as school_teachers_max_3y_max,min(c.school_teachers_max) over w_3y as school_teachers_max_3y_min,avg(c.municipio_count) over w_1y as municipio_count_1y_avg,max(c.municipio_count) over w_1y as municipio_count_1y_max,min(c.municipio_count) over w_1y as municipio_count_1y_min,avg(c.municipio_count) over w_2y as municipio_count_2y_avg,max(c.municipio_count) over w_2y as municipio_count_2y_max,min(c.municipio_count) over w_2y as municipio_count_2y_min,avg(c.municipio_count) over w_3y as municipio_count_3y_avg,max(c.municipio_count) over w_3y as municipio_count_3y_max,min(c.municipio_count) over w_3y as municipio_count_3y_min,avg(c.school_mismatch_min) over w_1y as school_mismatch_min_1y_avg,max(c.school_mismatch_min) over w_1y as school_mismatch_min_1y_max,min(c.school_mismatch_min) over w_1y as school_mismatch_min_1y_min,avg(c.school_mismatch_min) over w_2y as school_mismatch_min_2y_avg,max(c.school_mismatch_min) over w_2y as school_mismatch_min_2y_max,min(c.school_mismatch_min) over w_2y as school_mismatch_min_2y_min,avg(c.school_mismatch_min) over w_3y as school_mismatch_min_3y_avg,max(c.school_mismatch_min) over w_3y as school_mismatch_min_3y_max,min(c.school_mismatch_min) over w_3y as school_mismatch_min_3y_min,(bool_and(c.school_interventions_any) over w_1y)::int as school_interventions_any_1y_all,(bool_or(c.school_interventions_any) over w_1y)::int as school_interventions_any_1y_any,(bool_and(c.school_interventions_any) over w_2y)::int as school_interventions_any_2y_all,(bool_or(c.school_interventions_any) over w_2y)::int as school_interventions_any_2y_any,(bool_and(c.school_interventions_any) over w_3y)::int as school_interventions_any_3y_all,(bool_or(c.school_interventions_any) over w_3y)::int as school_interventions_any_3y_any,avg(c.school_program_safe_school_count) over w_1y as school_program_safe_school_count_1y_avg,max(c.school_program_safe_school_count) over w_1y as school_program_safe_school_count_1y_max,min(c.school_program_safe_school_count) over w_1y as school_program_safe_school_count_1y_min,avg(c.school_program_safe_school_count) over w_2y as school_program_safe_school_count_2y_avg,max(c.school_program_safe_school_count) over w_2y as school_program_safe_school_count_2y_max,min(c.school_program_safe_school_count) over w_2y as school_program_safe_school_count_2y_min,avg(c.school_program_safe_school_count) over w_3y as school_program_safe_school_count_3y_avg,max(c.school_program_safe_school_count) over w_3y as school_program_safe_school_count_3y_max,min(c.school_program_safe_school_count) over w_3y as school_program_safe_school_count_3y_min,(bool_and(c.school_owner_lease_any) over w_1y)::int as school_owner_lease_any_1y_all,(bool_or(c.school_owner_lease_any) over w_1y)::int as school_owner_lease_any_1y_any,(bool_and(c.school_owner_lease_any) over w_2y)::int as school_owner_lease_any_2y_all,(bool_or(c.school_owner_lease_any) over w_2y)::int as school_owner_lease_any_2y_any,(bool_and(c.school_owner_lease_any) over w_3y)::int as school_owner_lease_any_3y_all,(bool_or(c.school_owner_lease_any) over w_3y)::int as school_owner_lease_any_3y_any,array_to_string(array_agg(a.school_departamento) over w_1y, ',')  as school_departamento_1y,array_length(string_to_array(array_to_string(array_agg(a.school_departamento) over w_1y, ','), ','), 1) as school_departamento_1y_count,array_to_string(array_agg(a.school_departamento) over w_2y, ',')  as school_departamento_2y,array_length(string_to_array(array_to_string(array_agg(a.school_departamento) over w_2y, ','), ','), 1) as school_departamento_2y_count,array_to_string(array_agg(a.school_departamento) over w_3y, ',')  as school_departamento_3y,array_length(string_to_array(array_to_string(array_agg(a.school_departamento) over w_3y, ','), ','), 1) as school_departamento_3y_count,avg(a.school_classrooms) over w_1y as school_classrooms_1y_avg,max(a.school_classrooms) over w_1y as school_classrooms_1y_max,min(a.school_classrooms) over w_1y as school_classrooms_1y_min,avg(a.school_classrooms) over w_2y as school_classrooms_2y_avg,max(a.school_classrooms) over w_2y as school_classrooms_2y_max,min(a.school_classrooms) over w_2y as school_classrooms_2y_min,avg(a.school_classrooms) over w_3y as school_classrooms_3y_avg,max(a.school_classrooms) over w_3y as school_classrooms_3y_max,min(a.school_classrooms) over w_3y as school_classrooms_3y_min,avg(c.school_program_safe_school_count_max) over w_1y as school_program_safe_school_count_max_1y_avg,max(c.school_program_safe_school_count_max) over w_1y as school_program_safe_school_count_max_1y_max,min(c.school_program_safe_school_count_max) over w_1y as school_program_safe_school_count_max_1y_min,avg(c.school_program_safe_school_count_max) over w_2y as school_program_safe_school_count_max_2y_avg,max(c.school_program_safe_school_count_max) over w_2y as school_program_safe_school_count_max_2y_max,min(c.school_program_safe_school_count_max) over w_2y as school_program_safe_school_count_max_2y_min,avg(c.school_program_safe_school_count_max) over w_3y as school_program_safe_school_count_max_3y_avg,max(c.school_program_safe_school_count_max) over w_3y as school_program_safe_school_count_max_3y_max,min(c.school_program_safe_school_count_max) over w_3y as school_program_safe_school_count_max_3y_min,avg(c.family_members_min) over w_1y as family_members_min_1y_avg,max(c.family_members_min) over w_1y as family_members_min_1y_max,min(c.family_members_min) over w_1y as family_members_min_1y_min,avg(c.family_members_min) over w_2y as family_members_min_2y_avg,max(c.family_members_min) over w_2y as family_members_min_2y_max,min(c.family_members_min) over w_2y as family_members_min_2y_min,avg(c.family_members_min) over w_3y as family_members_min_3y_avg,max(c.family_members_min) over w_3y as family_members_min_3y_max,min(c.family_members_min) over w_3y as family_members_min_3y_min,(bool_and(c.school_electricity_all) over w_1y)::int as school_electricity_all_1y_all,(bool_or(c.school_electricity_all) over w_1y)::int as school_electricity_all_1y_any,(bool_and(c.school_electricity_all) over w_2y)::int as school_electricity_all_2y_all,(bool_or(c.school_electricity_all) over w_2y)::int as school_electricity_all_2y_any,(bool_and(c.school_electricity_all) over w_3y)::int as school_electricity_all_3y_all,(bool_or(c.school_electricity_all) over w_3y)::int as school_electricity_all_3y_any,avg(c.school_program_safe_school_count_min) over w_1y as school_program_safe_school_count_min_1y_avg,max(c.school_program_safe_school_count_min) over w_1y as school_program_safe_school_count_min_1y_max,min(c.school_program_safe_school_count_min) over w_1y as school_program_safe_school_count_min_1y_min,avg(c.school_program_safe_school_count_min) over w_2y as school_program_safe_school_count_min_2y_avg,max(c.school_program_safe_school_count_min) over w_2y as school_program_safe_school_count_min_2y_max,min(c.school_program_safe_school_count_min) over w_2y as school_program_safe_school_count_min_2y_min,avg(c.school_program_safe_school_count_min) over w_3y as school_program_safe_school_count_min_3y_avg,max(c.school_program_safe_school_count_min) over w_3y as school_program_safe_school_count_min_3y_max,min(c.school_program_safe_school_count_min) over w_3y as school_program_safe_school_count_min_3y_min,(bool_and(c.school_electricitycompany_any) over w_1y)::int as school_electricitycompany_any_1y_all,(bool_or(c.school_electricitycompany_any) over w_1y)::int as school_electricitycompany_any_1y_any,(bool_and(c.school_electricitycompany_any) over w_2y)::int as school_electricitycompany_any_2y_all,(bool_or(c.school_electricitycompany_any) over w_2y)::int as school_electricitycompany_any_2y_any,(bool_and(c.school_electricitycompany_any) over w_3y)::int as school_electricitycompany_any_3y_all,(bool_or(c.school_electricitycompany_any) over w_3y)::int as school_electricitycompany_any_3y_any,(bool_and(c.school_electricitycompany_all) over w_1y)::int as school_electricitycompany_all_1y_all,(bool_or(c.school_electricitycompany_all) over w_1y)::int as school_electricitycompany_all_1y_any,(bool_and(c.school_electricitycompany_all) over w_2y)::int as school_electricitycompany_all_2y_all,(bool_or(c.school_electricitycompany_all) over w_2y)::int as school_electricitycompany_all_2y_any,(bool_and(c.school_electricitycompany_all) over w_3y)::int as school_electricitycompany_all_3y_all,(bool_or(c.school_electricitycompany_all) over w_3y)::int as school_electricitycompany_all_3y_any,avg(c.school_toilet_avg) over w_1y as school_toilet_avg_1y_avg,max(c.school_toilet_avg) over w_1y as school_toilet_avg_1y_max,min(c.school_toilet_avg) over w_1y as school_toilet_avg_1y_min,avg(c.school_toilet_avg) over w_2y as school_toilet_avg_2y_avg,max(c.school_toilet_avg) over w_2y as school_toilet_avg_2y_max,min(c.school_toilet_avg) over w_2y as school_toilet_avg_2y_min,avg(c.school_toilet_avg) over w_3y as school_toilet_avg_3y_avg,max(c.school_toilet_avg) over w_3y as school_toilet_avg_3y_max,min(c.school_toilet_avg) over w_3y as school_toilet_avg_3y_min,avg(c.school_toiletsepticworks_avg) over w_1y as school_toiletsepticworks_avg_1y_avg,max(c.school_toiletsepticworks_avg) over w_1y as school_toiletsepticworks_avg_1y_max,min(c.school_toiletsepticworks_avg) over w_1y as school_toiletsepticworks_avg_1y_min,avg(c.school_toiletsepticworks_avg) over w_2y as school_toiletsepticworks_avg_2y_avg,max(c.school_toiletsepticworks_avg) over w_2y as school_toiletsepticworks_avg_2y_max,min(c.school_toiletsepticworks_avg) over w_2y as school_toiletsepticworks_avg_2y_min,avg(c.school_toiletsepticworks_avg) over w_3y as school_toiletsepticworks_avg_3y_avg,max(c.school_toiletsepticworks_avg) over w_3y as school_toiletsepticworks_avg_3y_max,min(c.school_toiletsepticworks_avg) over w_3y as school_toiletsepticworks_avg_3y_min,avg(c.departamento_count) over w_1y as departamento_count_1y_avg,max(c.departamento_count) over w_1y as departamento_count_1y_max,min(c.departamento_count) over w_1y as departamento_count_1y_min,avg(c.departamento_count) over w_2y as departamento_count_2y_avg,max(c.departamento_count) over w_2y as departamento_count_2y_max,min(c.departamento_count) over w_2y as departamento_count_2y_min,avg(c.departamento_count) over w_3y as departamento_count_3y_avg,max(c.departamento_count) over w_3y as departamento_count_3y_max,min(c.departamento_count) over w_3y as departamento_count_3y_min,(bool_and(c.school_rural_any) over w_1y)::int as school_rural_any_1y_all,(bool_or(c.school_rural_any) over w_1y)::int as school_rural_any_1y_any,(bool_and(c.school_rural_any) over w_2y)::int as school_rural_any_2y_all,(bool_or(c.school_rural_any) over w_2y)::int as school_rural_any_2y_any,(bool_and(c.school_rural_any) over w_3y)::int as school_rural_any_3y_all,(bool_or(c.school_rural_any) over w_3y)::int as school_rural_any_3y_any,(bool_and(c.school_program_pase_any) over w_1y)::int as school_program_pase_any_1y_all,(bool_or(c.school_program_pase_any) over w_1y)::int as school_program_pase_any_1y_any,(bool_and(c.school_program_pase_any) over w_2y)::int as school_program_pase_any_2y_all,(bool_or(c.school_program_pase_any) over w_2y)::int as school_program_pase_any_2y_any,(bool_and(c.school_program_pase_any) over w_3y)::int as school_program_pase_any_3y_all,(bool_or(c.school_program_pase_any) over w_3y)::int as school_program_pase_any_3y_any,avg(c.school_mismatch_avg) over w_1y as school_mismatch_avg_1y_avg,max(c.school_mismatch_avg) over w_1y as school_mismatch_avg_1y_max,min(c.school_mismatch_avg) over w_1y as school_mismatch_avg_1y_min,avg(c.school_mismatch_avg) over w_2y as school_mismatch_avg_2y_avg,max(c.school_mismatch_avg) over w_2y as school_mismatch_avg_2y_max,min(c.school_mismatch_avg) over w_2y as school_mismatch_avg_2y_min,avg(c.school_mismatch_avg) over w_3y as school_mismatch_avg_3y_avg,max(c.school_mismatch_avg) over w_3y as school_mismatch_avg_3y_max,min(c.school_mismatch_avg) over w_3y as school_mismatch_avg_3y_min,avg(c.school_toiletworks_max) over w_1y as school_toiletworks_max_1y_avg,max(c.school_toiletworks_max) over w_1y as school_toiletworks_max_1y_max,min(c.school_toiletworks_max) over w_1y as school_toiletworks_max_1y_min,avg(c.school_toiletworks_max) over w_2y as school_toiletworks_max_2y_avg,max(c.school_toiletworks_max) over w_2y as school_toiletworks_max_2y_max,min(c.school_toiletworks_max) over w_2y as school_toiletworks_max_2y_min,avg(c.school_toiletworks_max) over w_3y as school_toiletworks_max_3y_avg,max(c.school_toiletworks_max) over w_3y as school_toiletworks_max_3y_max,min(c.school_toiletworks_max) over w_3y as school_toiletworks_max_3y_min,sum(b.label) over w_1y as dropout_1y, sum(b.label) over w_2y as dropout_2y, sum(b.label) over w_3y as dropout_3y from results.features_imputed a left join staging.labels as b on a.student=b.student and a.year_range=b.year_range left join results.features_aggregate c on a.student=c.student and a.year_range=c.year_range window w_1y as (partition by a.student order by a.year_range asc rows between 1 preceding and current row), w_2y as (partition by a.student order by a.year_range asc rows between 2 preceding and current row), w_3y as (partition by a.student order by a.year_range asc rows between 3 preceding and current row)); create index nonimputed_year_range_student_idx on results.features_aggregate2(year_range, student);